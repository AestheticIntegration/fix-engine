(* Aesthetic Integration copyright 2019 *)
open Decoders_yojson.Basic.Decode;;
open Decoders_yojson.Basic.Decode.Infix;;
open Model_messages;;

let model_message_decoder  : model_msg decoder =
    (field "tag" string) >>= (fun x -> (match x with
        | d -> (fail ("Unknown Message ("^d^") in JSON decoding."))
    )
    )
;;

let top_level_message_decoder  : model_top_level_msg decoder =
    (field "top_level_msg" string) >>= (fun f -> (match f with
        | _ -> (succeed FIX_TL_None)
    )
    )
;;
