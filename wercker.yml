no-response-timeout: 60
command-timeout: 60
build:
  box:
    id: ocaml/opam2
    tag: debian-9-ocaml-4.06
    entrypoint: /usr/bin/sudo -u root --preserve-env opam config exec --
    cmd: /bin/bash
  steps:
    - script:
        name: dune make       
        code: |          
          set -ex
          apt-get update && apt-get install -y libgmp-dev zlib1g-dev
          export OPAMROOT=/home/opam/.opam
          opam repo set-url default https://opam.ocaml.org
          opam update
          curl -s "https://storage.googleapis.com/imandra-installer/install.sh" > /home/opam/install.sh          
          echo -e "/usr/local/bin\n" | sh /home/opam/install.sh -n
          opam exec --switch=/usr/local/var/imandra -- make opam1-setup
          export PATH=/usr/local/bin/:$PATH
          opam exec --switch=/usr/local/var/imandra -- make 
