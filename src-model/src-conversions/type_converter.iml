(* Imandra Inc. copyright 2021 *)
[@@@import "../../src-protocol-exts/full_app_messages.iml"]
open Full_app_messages;;
[@@@import "../src-types/model_messages.iml"]
open Model_messages;;
[@@@import "../src-types/model_tags.iml"]
open Model_tags;;


let convert__full_to_model_NewOrderSingle (msg : full_fix_newordersingle_data)  =
    (match msg.f_NewOrderSingle_Price with
        | None -> (FIX_TL_Req_Field_Missing {
            field_missing_of_invalid_data_msg = M_Msg_NewOrderSingle_Tag;
            field_missing_or_invalid_data_field = M_Field_Price_Tag;
            repeating_group_origin = None
        })
        | Some m_f_NewOrderSingle_Price -> let c_mod_f_NewOrderSingle_Price = m_f_NewOrderSingle_Price
        in
        let fix_msg_data = {
            mod_def_opt_f_NewOrderSingle_Price = c_mod_f_NewOrderSingle_Price
        }
        in
        FIX_TL_Normal (FIX_Msg_Def_Opt_NewOrderSingle fix_msg_data)
    )
;;

let convert_full_to_model_fix (msg : full_app_msg_data)  =
    (match msg with
        | FIX_Full_Msg_NewOrderSingle msg_data -> (convert__full_to_model_NewOrderSingle msg_data)
    )
    [@@macro]
;;

let convert__model_to_full_NewOrderSingle (msg : mod_newordersingle_data)  =
    FIX_Full_Msg_NewOrderSingle {
        f_NewOrderSingle_Price = Some msg.mod_f_NewOrderSingle_Price
    }
    [@@macro]
;;

let convert_model_to_full_fix (msg : model_msg)  =
    (match msg with
        | FIX_Msg_NewOrderSingle msg_data -> (convert__model_to_full_NewOrderSingle msg_data)
    )
    [@@macro]
;;

