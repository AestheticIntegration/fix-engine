(* Imandra Inc. copyright 2021 *)
[@@@program]
[@@@import "../src-core-pp/base_types_json.iml"]
open Base_types_json;;
[@@@import "../src-core-pp/datetime_json.iml"]
open Datetime_json;;
[@@@require "decoders-yojson"]
open Decoders_yojson.Basic.Decode;;
[@@@require "decoders-yojson"]
open Decoders_yojson.Basic.Decode.Infix;;
[@@@import "../src-protocol-exts/full_app_messages.iml"]
open Full_app_messages;;


let full_message_newordersingle_decoder  : full_fix_newordersingle_data decoder =
    (maybe (field "Price" float_6_decoder)) >>= (fun f_NewOrderSingle_Price -> 
    succeed {
        f_NewOrderSingle_Price = f_NewOrderSingle_Price
    }
    )
;;

let full_app_msg_of_json  : full_app_msg_data decoder =
    single_field (fun x -> 
    (match x with
        | "NewOrderSingle" -> (full_message_newordersingle_decoder >>= (fun y -> 
        succeed (FIX_Full_Msg_NewOrderSingle y)
        ))
        | d -> (fail ("Unknown Message ("^d^") in JSON decoding."))
    )
    )
;;

[@@@logic]
