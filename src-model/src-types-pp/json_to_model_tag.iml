(* Aesthetic Integration copyright 2018 *)
open Decoders_yojson.Basic.Decode;;
open Decoders_yojson.Basic.Decode.Infix;;
open Model_messages;;
open Model_tag_names;;
open Model_tags;;

let message_tag_decoder  : m_msg_tag decoder =
    string >>= (fun x -> (match tag_to_message x with
        | None -> (fail ("Unknown message tag ("^x^") in decoding"))
        | Some y -> (succeed y)
    )
    )
;;

let field_tag_decoder  : m_field_tag decoder =
    string >>= (fun x -> (match tag_to_field x with
        | None -> (fail ("Unknown field tag ("^x^") in decoding"))
        | Some y -> (succeed y)
    )
    )
;;

let field_missing_data_decoder  : field_missing_data decoder =
    (field "m_msg_tag" message_tag_decoder) >>= (fun msg -> (field "m_field_tag" field_tag_decoder) >>= (fun f -> succeed {
        field_missing_data_field = f;
        field_missing_data_msg = msg
    }
    )
    )
;;
