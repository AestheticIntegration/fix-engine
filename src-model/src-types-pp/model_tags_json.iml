(* Aesthetic Integration copyright 2018 *)
open Model_messages;;
open Model_tags;;
open Yojson;;

let json_of_model_msg_tag (msg : m_msg_tag)  : json =
    (match msg with
        | M_Msg_NewOrderSingle_Tag -> (`String "D")
        | M_Msg_OrderCancel_Tag -> (`String "F")
        | M_Msg_NewOrder_Multi_Leg_Tag -> (`String "AB")
        | M_Msg_NewOrder_List_Tag -> (`String "E")
        | M_Msg_ListOrderCancel_Tag -> (`String "K")
        | M_Msg_BusinessMessageReject_Tag -> (`String "j")
        | M_Msg_AllocationReport_Tag -> (`String "AS")
        | M_Msg_AllocationReportACK_Tag -> (`String "AT")
        | M_Msg_AllocationInstruction_Tag -> (`String "J")
        | M_Msg_Heartbeat_Tag -> (`String "0")
        | M_Msg_TestRequest_Tag -> (`String "1")
        | M_Msg_ResendRequest_Tag -> (`String "2")
        | M_Msg_SessionLevelReject_Tag -> (`String "3")
        | M_Msg_SequenceResetRequest_Tag -> (`String "4")
        | M_Msg_Logout_Tag -> (`String "5")
        | M_Msg_FIXLogon_Tag -> (`String "A")
        | M_Msg_DontKnowTrade_Tag -> (`String "Q")
    )
;;

let json_of_model_field_tag (x : m_field_tag)  : json =
    (match x with
        | M_Field_Symbol_Tag -> (`String "55")
        | M_Field_ListID_Tag -> (`String "66")
        | M_Field_TestReqID_Tag -> (`String "112")
        | M_Field_EncryptMethod_Tag -> (`String "98")
        | M_Field_AllocReportID_Tag -> (`String "755")
        | M_Field_Side_Tag -> (`String "54")
        | M_Field_Instrument_Tag -> (`String "")
        | M_Field_RefSeqNum_Tag -> (`String "45")
        | M_Field_TradeDate_Tag -> (`String "75")
        | M_Field_ExecID_Tag -> (`String "17")
        | M_Field_Parties_Tag -> (`String "")
        | M_Field_AllocNoOrdersType_Tag -> (`String "857")
        | M_Field_Text_Tag -> (`String "58")
        | M_Field_ClOrdID_Tag -> (`String "11112")
        | M_Field_RefTagID_Tag -> (`String "371")
        | M_Field_AllocType_Tag -> (`String "626")
        | M_Field_TransactTime_Tag -> (`String "60")
        | M_Field_SessionRejectReason_Tag -> (`String "373")
        | M_Field_NewSeqNo_Tag -> (`String "36")
        | M_Field_RefMsgTyp_Tag -> (`String "372")
        | M_Field_OrigClOrdID_Tag -> (`String "41")
        | M_Field_BusinessRejectReason_Tag -> (`String "380")
        | M_Field_AllocReportType_Tag -> (`String "794")
        | M_Field_OrderID_Tag -> (`String "37")
        | M_Field_AllocStatus_Tag -> (`String "87")
        | M_Field_Quantity_Tag -> (`String "53")
        | M_Field_CFICode_Tag -> (`String "461")
        | M_Field_AvgPx_Tag -> (`String "6")
        | M_Field_DKReason_Tag -> (`String "127")
        | M_Field_TotalNoOrders_Tag -> (`String "68")
        | M_Field_BidType_Tag -> (`String "394")
        | M_Field_BeginSeqNo_Tag -> (`String "7")
        | M_Field_OrdType_Tag -> (`String "40")
        | M_Field_AllocID_Tag -> (`String "70")
        | M_Field_HeartBtInt_Tag -> (`String "108")
        | M_Field_InstrumentLeg_Tag -> (`String "")
        | M_Field_EndSeqNo_Tag -> (`String "16")
        | M_Field_AllocTransType_Tag -> (`String "71")
        | M_Field_OrderQty_Tag -> (`String "38")
        | M_Field_LegSecurityIDSource_Tag -> (`String "100")
        | M_Field_LegSecurityID_Tag -> (`String "100")
        | M_Field_LegSymbol_Tag -> (`String "100")
    )
;;

let json_of_req_field_missing (x : field_missing_data)  : json =
    `Assoc (("m_msg_tag",json_of_model_msg_tag x.field_missing_data_msg) :: (("m_field_tag",json_of_model_field_tag x.field_missing_data_field) :: []))
;;
