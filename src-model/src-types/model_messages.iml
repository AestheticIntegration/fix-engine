(* Aesthetic Integration copyright 2018 *)
open Datetime;;
open Model_app_enums;;
open Model_repeating_groups;;
open Model_tags;;
open Numeric;;

type mod_newordersingle_data = {
    mod_f_NewOrderSingle_ClOrdID : string;
    mod_f_NewOrderSingle_Currency : string option;
    mod_f_NewOrderSingle_HandlInst : model_fix_handlinst option;
    mod_f_NewOrderSingle_Parties_PartyIDsGrp : model_fix_rec_partyidsgrp;
    mod_f_NewOrderSingle_ExecInst : model_fix_execinst option;
    mod_f_NewOrderSingle_OrderQty : fix_float_6;
    mod_f_NewOrderSingle_OrdType : string;
    mod_f_NewOrderSingle_Price : fix_float_6 option;
    mod_f_NewOrderSingle_Side : model_fix_side;
    mod_f_NewOrderSingle_TransactTime : fix_utctimestamp_milli;
    mod_f_NewOrderSingle_SettlType : model_fix_settltype option;
    mod_f_NewOrderSingle_SettlDate : fix_localmktdate option;
    mod_f_NewOrderSingle_OrderCapacity : model_fix_ordercapacity option;
    mod_f_NewOrderSingle_QtyType : model_fix_qtytype option;
    mod_f_NewOrderSingle_Instrument_CFICode : string;
    mod_f_NewOrderSingle_ForexReq : model_fix_forexreq option;
    mod_f_NewOrderSingle_SettlCurrency : string option;
    mod_f_NewOrderSingle_IncludeDealers : model_fix_includedealers option;
    mod_f_NewOrderSingle_DealersGrp : model_fix_rec_dealersgrp;
    mod_f_NewOrderSingle_TradingProtocol : model_fix_tradingprotocol option;
    mod_f_NewOrderSingle_MKTXPricingProcess : model_fix_mktxpricingprocess option;
    mod_f_NewOrderSingle_MKTXTargetLevel : fix_float_6 option;
    mod_f_NewOrderSingle_MKTXExternalTargetLevel : fix_float_6 option;
    mod_f_NewOrderSingle_MKTXRTSPurpose : model_fix_mktxrtspurpose option;
    mod_f_NewOrderSingle_SpreadorBenchmarkCurveData_BenchmarkCurveCurrency : fix_float_6 option;
    mod_f_NewOrderSingle_PriceType : model_fix_pricetype option;
    mod_f_NewOrderSingle_Text : string option;
    mod_f_NewOrderSingle_AllocID : string option;
    mod_f_NewOrderSingle_AllocsGrp : model_fix_rec_allocsgrp
}
;;

type mod_ordercancel_data = {
    mod_f_OrderCancel_OrigClOrdID : string;
    mod_f_OrderCancel_ClOrdID : string;
    mod_f_OrderCancel_Parties_PartyIDsGrp : model_fix_rec_partyidsgrp;
    mod_f_OrderCancel_Symbol : string;
    mod_f_OrderCancel_Side : model_fix_side;
    mod_f_OrderCancel_TransactTime : fix_utctimestamp_milli
}
;;

type mod_neworder_multi_leg_data = {
    mod_f_NewOrder_Multi_Leg_ClOrdID : string;
    mod_f_NewOrder_Multi_Leg_Parties_PartyIDsGrp : model_fix_rec_partyidsgrp;
    mod_f_NewOrder_Multi_Leg_Side : model_fix_side option;
    mod_f_NewOrder_Multi_Leg_Instrument_CFICode : string;
    mod_f_NewOrder_Multi_Leg_OrderCapacity : model_fix_ordercapacity option;
    mod_f_NewOrder_Multi_Leg_LegsGrp : model_fix_rec_legsgrp;
    mod_f_NewOrder_Multi_Leg_TransactTime : fix_utctimestamp_milli;
    mod_f_NewOrder_Multi_Leg_QtyType : model_fix_qtytype option;
    mod_f_NewOrder_Multi_Leg_OrderQty : fix_float_6 option;
    mod_f_NewOrder_Multi_Leg_OrdType : string;
    mod_f_NewOrder_Multi_Leg_Text : string option;
    mod_f_NewOrder_Multi_Leg_Notes : string option;
    mod_f_NewOrder_Multi_Leg_IncludeDealers : model_fix_includedealers option;
    mod_f_NewOrder_Multi_Leg_DealersGrp : model_fix_rec_dealersgrp;
    mod_f_NewOrder_Multi_Leg_TradingProtocol : model_fix_tradingprotocol option;
    mod_f_NewOrder_Multi_Leg_MKTXPricingProcess : model_fix_mktxpricingprocess option;
    mod_f_NewOrder_Multi_Leg_MKTXLegExternalTargetLevel : int option;
    mod_f_NewOrder_Multi_Leg_MKTXRTSPurpose : model_fix_mktxrtspurpose option;
    mod_f_NewOrder_Multi_Leg_AllocID : string option;
    mod_f_NewOrder_Multi_Leg_LegAllocsGrp : model_fix_rec_legallocsgrp
}
;;

type mod_neworder_list_data = {
    mod_f_NewOrder_List_ListID : string;
    mod_f_NewOrder_List_BidType : int;
    mod_f_NewOrder_List_TotalNoOrders : int;
    mod_f_NewOrder_List_OrdersGrp : model_fix_rec_ordersgrp;
    mod_f_NewOrder_List_IncludeDealers : model_fix_includedealers option;
    mod_f_NewOrder_List_DealersGrp : model_fix_rec_dealersgrp;
    mod_f_NewOrder_List_OrderCapacity : model_fix_ordercapacity option;
    mod_f_NewOrder_List_MKTXPricingProcess : model_fix_mktxpricingprocess option;
    mod_f_NewOrder_List_MKTXExternalTargetLevel : fix_float_6 option;
    mod_f_NewOrder_List_MKTXListType : model_fix_mktxlisttype option;
    mod_f_NewOrder_List_AllocID : string option;
    mod_f_NewOrder_List_AllocsGrp : model_fix_rec_allocsgrp
}
;;

type mod_listordercancel_data = {
    mod_f_ListOrderCancel_ListID : string;
    mod_f_ListOrderCancel_TransactTime : fix_utctimestamp_milli
}
;;

type mod_ordercancelreject_data = {
    mod_f_OrderCancelReject_ListID : string option;
    mod_f_OrderCancelReject_OrderID : string;
    mod_f_OrderCancelReject_ClOrdID : string;
    mod_f_OrderCancelReject_OrdStatus : model_fix_ordstatus;
    mod_f_OrderCancelReject_OrigClOrdID : string;
    mod_f_OrderCancelReject_CxlRejResponseTo : model_fix_cxlrejresponseto;
    mod_f_OrderCancelReject_CxlRejReason : model_fix_cxlrejreason option;
    mod_f_OrderCancelReject_TransactTime : fix_utctimestamp_milli;
    mod_f_OrderCancelReject_Text : string
}
;;

type mod_businessmessagereject_data = {
    mod_f_BusinessMessageReject_RefSeqNum : int option;
    mod_f_BusinessMessageReject_RefMsgTyp : string;
    mod_f_BusinessMessageReject_BusinessRejectRefID : string option;
    mod_f_BusinessMessageReject_BusinessRejectReason : model_fix_businessrejectreason;
    mod_f_BusinessMessageReject_Text : string option
}
;;

type mod_allocationreport_data = {
    mod_f_AllocationReport_AllocReportID : string;
    mod_f_AllocationReport_AllocID : string option;
    mod_f_AllocationReport_AllocTransType : model_fix_alloctranstype;
    mod_f_AllocationReport_AllocReportRefID : string option;
    mod_f_AllocationReport_AllocCancReplaceReason : model_fix_alloccancreplacereason option;
    mod_f_AllocationReport_RefAllocID : string option;
    mod_f_AllocationReport_AllocReportType : model_fix_allocreporttype;
    mod_f_AllocationReport_AllocStatus : model_fix_allocstatus;
    mod_f_AllocationReport_AllocNoOrdersType : model_fix_allocnoorderstype;
    mod_f_AllocationReport_OrdersGrp : model_fix_rec_ordersgrp;
    mod_f_AllocationReport_ExecsGrp : model_fix_rec_execsgrp;
    mod_f_AllocationReport_Side : model_fix_side;
    mod_f_AllocationReport_Instrument_CFICode : string;
    mod_f_AllocationReport_Quantity : fix_float_6;
    mod_f_AllocationReport_QtyType : model_fix_qtytype option;
    mod_f_AllocationReport_PriceType : model_fix_pricetype option;
    mod_f_AllocationReport_AvgPx : fix_float_6;
    mod_f_AllocationReport_SpreadorBenchmarkCurveData_BenchmarkCurveCurrency : fix_float_6 option;
    mod_f_AllocationReport_Currency : string option;
    mod_f_AllocationReport_Parties_PartyIDsGrp : model_fix_rec_partyidsgrp;
    mod_f_AllocationReport_TradeDate : fix_localmktdate;
    mod_f_AllocationReport_TransactTime : fix_utctimestamp_milli option;
    mod_f_AllocationReport_SettlDate : fix_localmktdate option;
    mod_f_AllocationReport_GrossTradeAmt : fix_float_6 option;
    mod_f_AllocationReport_NetMoney : fix_float_6 option;
    mod_f_AllocationReport_Text : string option;
    mod_f_AllocationReport_AccruedInterestAmt : fix_float_6 option;
    mod_f_AllocationReport_YieldType : model_fix_yieldtype option;
    mod_f_AllocationReport_Yield : fix_float_6 option;
    mod_f_AllocationReport_AllocsGrp : model_fix_rec_allocsgrp;
    mod_f_AllocationReport_Notes : string option;
    mod_f_AllocationReport_MKTXPricingProcess : model_fix_mktxpricingprocess option
}
;;

type mod_allocationreportack_data = {
    mod_f_AllocationReportACK_AllocReportID : string;
    mod_f_AllocationReportACK_AllocID : string;
    mod_f_AllocationReportACK_TradeDate : fix_localmktdate option;
    mod_f_AllocationReportACK_TransactTime : fix_utctimestamp_milli;
    mod_f_AllocationReportACK_AllocStatus : model_fix_allocstatus;
    mod_f_AllocationReportACK_AllocRejCode : model_fix_allocrejcode option;
    mod_f_AllocationReportACK_AllocReportType : model_fix_allocreporttype option;
    mod_f_AllocationReportACK_Text : string option
}
;;

type mod_allocationinstruction_data = {
    mod_f_AllocationInstruction_AllocID : string;
    mod_f_AllocationInstruction_AllocTransType : model_fix_alloctranstype;
    mod_f_AllocationInstruction_AllocType : model_fix_alloctype;
    mod_f_AllocationInstruction_RefAllocID : string option;
    mod_f_AllocationInstruction_AllocCancReplaceReason : model_fix_alloccancreplacereason option;
    mod_f_AllocationInstruction_AllocNoOrdersType : model_fix_allocnoorderstype;
    mod_f_AllocationInstruction_OrdersGrp : model_fix_rec_ordersgrp;
    mod_f_AllocationInstruction_ExecsGrp : model_fix_rec_execsgrp;
    mod_f_AllocationInstruction_Side : model_fix_side;
    mod_f_AllocationInstruction_Instrument_CFICode : string;
    mod_f_AllocationInstruction_Quantity : fix_float_6;
    mod_f_AllocationInstruction_AvgPx : fix_float_6;
    mod_f_AllocationInstruction_TradeDate : fix_localmktdate;
    mod_f_AllocationInstruction_TransactTime : fix_utctimestamp_milli option;
    mod_f_AllocationInstruction_Text : string option;
    mod_f_AllocationInstruction_AllocsGrp : model_fix_rec_allocsgrp
}
;;

type mod_allocationinstructionack_data = {
    mod_f_AllocationInstructionACK_AllocID : string;
    mod_f_AllocationInstructionACK_Parties_PartyIDsGrp : model_fix_rec_partyidsgrp;
    mod_f_AllocationInstructionACK_TradeDate : fix_localmktdate option;
    mod_f_AllocationInstructionACK_TransactTime : fix_utctimestamp_milli;
    mod_f_AllocationInstructionACK_AllocStatus : model_fix_allocstatus;
    mod_f_AllocationInstructionACK_AllocRejCode : model_fix_allocrejcode option;
    mod_f_AllocationInstructionACK_AllocType : model_fix_alloctype option;
    mod_f_AllocationInstructionACK_Text : string option
}
;;

type mod_heartbeat_data = {
    mod_f_Heartbeat_TestReqID : string option
}
;;

type mod_testrequest_data = {
    mod_f_TestRequest_TestReqID : string
}
;;

type mod_resendrequest_data = {
    mod_f_ResendRequest_BeginSeqNo : int;
    mod_f_ResendRequest_EndSeqNo : int
}
;;

type mod_sessionlevelreject_data = {
    mod_f_SessionLevelReject_RefSeqNum : int;
    mod_f_SessionLevelReject_Text : string;
    mod_f_SessionLevelReject_RefTagID : int;
    mod_f_SessionLevelReject_RefMsgTyp : string;
    mod_f_SessionLevelReject_SessionRejectReason : model_fix_sessionrejectreason
}
;;

type mod_sequenceresetrequest_data = {
    mod_f_SequenceResetRequest_GapFillFlag : model_fix_gapfillflag option;
    mod_f_SequenceResetRequest_NewSeqNo : int
}
;;

type mod_logout_data = {
    mod_f_Logout_Text : string option
}
;;

type mod_fixlogon_data = {
    mod_f_FIXLogon_EncryptMethod : int;
    mod_f_FIXLogon_HeartBtInt : int;
    mod_f_FIXLogon_ResetSeqNumFlag : bool option
}
;;

type mod_executionreport_data = {
    mod_f_ExecutionReport_ClOrdID : string option;
    mod_f_ExecutionReport_OrigClOrdID : string option;
    mod_f_ExecutionReport_OrderID : string;
    mod_f_ExecutionReport_Parties_PartyIDsGrp : model_fix_rec_partyidsgrp;
    mod_f_ExecutionReport_ListID : string option;
    mod_f_ExecutionReport_MKTXCPTYLEI : string option;
    mod_f_ExecutionReport_MKTXPartyLEI : string option;
    mod_f_ExecutionReport_OrderCapacity : model_fix_ordercapacity option;
    mod_f_ExecutionReport_MKTXInquiryID : string option;
    mod_f_ExecutionReport_MKTXTrdRegPublicationReason : model_fix_mktxtrdregpublicationreason option;
    mod_f_ExecutionReport_TrdRegPublicationsGrp : model_fix_rec_trdregpublicationsgrp;
    mod_f_ExecutionReport_MKTXESCBStblty : model_fix_mktxescbstblty option;
    mod_f_ExecutionReport_PreTradeWaiver : model_fix_pretradewaiver option;
    mod_f_ExecutionReport_MKTXTradeReportingInd : model_fix_mktxtradereportingind option;
    mod_f_ExecutionReport_TradeReportingIndicator : model_fix_tradereportingindicator option;
    mod_f_ExecutionReport_InternalCrossingFlag : model_fix_internalcrossingflag option;
    mod_f_ExecutionReport_RegulatoryTradeIDsGrp : model_fix_rec_regulatorytradeidsgrp;
    mod_f_ExecutionReport_MKTXVenueTransactionID : string option;
    mod_f_ExecutionReport_ExecID : string;
    mod_f_ExecutionReport_ExecRefID : string option;
    mod_f_ExecutionReport_HandlInst : model_fix_handlinst option;
    mod_f_ExecutionReport_LastMkt : string option;
    mod_f_ExecutionReport_ExecType : model_fix_exectype option;
    mod_f_ExecutionReport_SecondaryExecID : string option;
    mod_f_ExecutionReport_OrdStatus : model_fix_ordstatus;
    mod_f_ExecutionReport_OrdRejReason : model_fix_ordrejreason option;
    mod_f_ExecutionReport_SettlDate : fix_localmktdate option;
    mod_f_ExecutionReport_IssueDate : fix_localmktdate option;
    mod_f_ExecutionReport_Instrument_CFICode : string;
    mod_f_ExecutionReport_Price : fix_float_6 option;
    mod_f_ExecutionReport_Side : model_fix_side;
    mod_f_ExecutionReport_OrderQty : fix_float_6 option;
    mod_f_ExecutionReport_PriceType : model_fix_pricetype option;
    mod_f_ExecutionReport_Currency : string option;
    mod_f_ExecutionReport_LastPx : fix_float_6 option;
    mod_f_ExecutionReport_LastParPx : fix_float_6 option;
    mod_f_ExecutionReport_LeavesQty : fix_float_6;
    mod_f_ExecutionReport_CumQty : fix_float_6;
    mod_f_ExecutionReport_AvgPx : fix_float_6;
    mod_f_ExecutionReport_TradeDate : fix_localmktdate option;
    mod_f_ExecutionReport_TransactTime : fix_utctimestamp_milli option;
    mod_f_ExecutionReport_SpreadorBenchmarkCurveData_BenchmarkCurveCurrency : fix_float_6;
    mod_f_ExecutionReport_YieldType : model_fix_yieldtype option;
    mod_f_ExecutionReport_Yield : fix_float_6 option;
    mod_f_ExecutionReport_GrossTradeAmt : fix_float_6 option;
    mod_f_ExecutionReport_AccruedInterestAmt : fix_float_6 option;
    mod_f_ExecutionReport_NetMoney : fix_float_6 option;
    mod_f_ExecutionReport_SettlCurrAmt : fix_float_6 option;
    mod_f_ExecutionReport_SettlCurrency : string option;
    mod_f_ExecutionReport_SettlCurrFxRate : fix_float option;
    mod_f_ExecutionReport_SettlCurrFxRateCalc : string option;
    mod_f_ExecutionReport_Text : string option;
    mod_f_ExecutionReport_LegsGrp : model_fix_rec_legsgrp;
    mod_f_ExecutionReport_IncludeDealers : model_fix_includedealers option;
    mod_f_ExecutionReport_DealersGrp : model_fix_rec_dealersgrp;
    mod_f_ExecutionReport_Notes : string option;
    mod_f_ExecutionReport_TradingProtocol : model_fix_tradingprotocol option;
    mod_f_ExecutionReport_NumberofTrades : int option;
    mod_f_ExecutionReport_LegTransactionSeqNumberLegID : string option;
    mod_f_ExecutionReport_InquiryQty : fix_float_6;
    mod_f_ExecutionReport_NumDaysInterest : int option;
    mod_f_ExecutionReport_DatedDate_2 : fix_localmktdate option;
    mod_f_ExecutionReport_BrokerReceiptTime : fix_utctimestamp_milli option;
    mod_f_ExecutionReport_GSpread : fix_float option;
    mod_f_ExecutionReport_ZSpread : fix_float_6 option;
    mod_f_ExecutionReport_ISpread : fix_float_6 option;
    mod_f_ExecutionReport_ASWSpread : fix_float_6 option;
    mod_f_ExecutionReport_OASSpread : fix_float_6 option;
    mod_f_ExecutionReport_MKTXCostAnalysisGrp : model_fix_rec_mktxcostanalysisgrp;
    mod_f_ExecutionReport_MKTXPricingProcess : model_fix_mktxpricingprocess option;
    mod_f_ExecutionReport_MKTXTargetLevel : fix_float_6 option;
    mod_f_ExecutionReport_ClientBook : string option;
    mod_f_ExecutionReport_DirtyPrice : fix_float_6 option;
    mod_f_ExecutionReport_LastCapacity : model_fix_lastcapacity option;
    mod_f_ExecutionReport_MKTXTradeStyle : model_fix_mktxtradestyle option;
    mod_f_ExecutionReport_MKTXCompositeBidSpread : string option;
    mod_f_ExecutionReport_MKTXCompositeOfferSpread : fix_float_6 option;
    mod_f_ExecutionReport_MKTXCompositeBidPrice : fix_float_6 option;
    mod_f_ExecutionReport_MKTXCompositeOfferPrice : fix_float_6 option;
    mod_f_ExecutionReport_MKTXCompositeBidMMEYield : fix_float_6 option;
    mod_f_ExecutionReport_MKTXCompositeOfferMMEYield : fix_float_6 option;
    mod_f_ExecutionReport_MKTXCompositeLiquidityScore : fix_float_6 option;
    mod_f_ExecutionReport_MKTXAutoExType : model_fix_mktxautoextype option;
    mod_f_ExecutionReport_MKTXAutoExStatus : model_fix_mktxautoexstatus option;
    mod_f_ExecutionReport_MKTXAutoExDesc : string option;
    mod_f_ExecutionReport_MKTXAutoExRefLevel : string option;
    mod_f_ExecutionReport_MKTXAutoExRefLevelType : model_fix_mktxautoexrefleveltype option;
    mod_f_ExecutionReport_ExpireTime : fix_utctimestamp_milli option;
    mod_f_ExecutionReport_LastQty : fix_float_6 option
}
;;

type mod_dontknowtrade_data = {
    mod_f_DontKnowTrade_OrderID : string;
    mod_f_DontKnowTrade_ExecID : string;
    mod_f_DontKnowTrade_DKReason : model_fix_dkreason;
    mod_f_DontKnowTrade_Side : model_fix_side;
    mod_f_DontKnowTrade_LastQty : fix_float_6 option;
    mod_f_DontKnowTrade_LastPx : fix_float_6 option;
    mod_f_DontKnowTrade_Text : string option;
    mod_f_DontKnowTrade_SecondaryOrderID : string option;
    mod_f_DontKnowTrade_EncodedTextLen : int option;
    mod_f_DontKnowTrade_EncodedText : string option
}
;;

type model_msg =
    | FIX_Msg_NewOrderSingle of mod_newordersingle_data
    | FIX_Msg_OrderCancel of mod_ordercancel_data
    | FIX_Msg_NewOrder_Multi_Leg of mod_neworder_multi_leg_data
    | FIX_Msg_NewOrder_List of mod_neworder_list_data
    | FIX_Msg_ListOrderCancel of mod_listordercancel_data
    | FIX_Msg_OrderCancelReject of mod_ordercancelreject_data
    | FIX_Msg_BusinessMessageReject of mod_businessmessagereject_data
    | FIX_Msg_AllocationReport of mod_allocationreport_data
    | FIX_Msg_AllocationReportACK of mod_allocationreportack_data
    | FIX_Msg_AllocationInstruction of mod_allocationinstruction_data
    | FIX_Msg_AllocationInstructionACK of mod_allocationinstructionack_data
    | FIX_Msg_Heartbeat of mod_heartbeat_data
    | FIX_Msg_TestRequest of mod_testrequest_data
    | FIX_Msg_ResendRequest of mod_resendrequest_data
    | FIX_Msg_SessionLevelReject of mod_sessionlevelreject_data
    | FIX_Msg_SequenceResetRequest of mod_sequenceresetrequest_data
    | FIX_Msg_Logout of mod_logout_data
    | FIX_Msg_FIXLogon of mod_fixlogon_data
    | FIX_Msg_ExecutionReport of mod_executionreport_data
    | FIX_Msg_DontKnowTrade of mod_dontknowtrade_data
;;

let is_msg_inbound (msg : model_msg)  =
    (match msg with
        | FIX_Msg_NewOrderSingle _ -> true
        | FIX_Msg_OrderCancel _ -> true
        | FIX_Msg_NewOrder_Multi_Leg _ -> true
        | FIX_Msg_NewOrder_List _ -> true
        | FIX_Msg_ListOrderCancel _ -> true
        | FIX_Msg_OrderCancelReject _ -> false
        | FIX_Msg_BusinessMessageReject _ -> true
        | FIX_Msg_AllocationReport _ -> true
        | FIX_Msg_AllocationReportACK _ -> true
        | FIX_Msg_AllocationInstruction _ -> true
        | FIX_Msg_AllocationInstructionACK _ -> false
        | FIX_Msg_Heartbeat _ -> true
        | FIX_Msg_TestRequest _ -> true
        | FIX_Msg_ResendRequest _ -> true
        | FIX_Msg_SessionLevelReject _ -> true
        | FIX_Msg_SequenceResetRequest _ -> true
        | FIX_Msg_Logout _ -> true
        | FIX_Msg_FIXLogon _ -> true
        | FIX_Msg_ExecutionReport _ -> false
        | FIX_Msg_DontKnowTrade _ -> true
    )
;;

type field_missing_data = {
    field_missing_data_field : m_field_tag;
    field_missing_data_msg : m_msg_tag
}
;;

type model_top_level_msg =
    | FIX_TL_Normal of model_msg
    | FIX_TL_Req_Field_Missing of field_missing_data
    | FIX_TL_PossibleResend of model_msg
    | FIX_TL_None 
;;
