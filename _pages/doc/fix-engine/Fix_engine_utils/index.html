<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Fix_engine_utils (fix-engine.Fix_engine_utils)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">fix-engine</a> &#x00BB; Fix_engine_utils</nav><h1>Module <code>Fix_engine_utils</code></h1><p>FIX 4.4 engine utility functions.</p></header><dl><dt class="spec value" id="val-msg_is_sequence_gap"><a href="#val-msg_is_sequence_gap" class="anchor"></a><code><span class="keyword">val </span>msg_is_sequence_gap : (<a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a><span class="keyword"> * </span><a href="../Full_messages/index.html#type-fix_header">Full_messages.fix_header</a>) <span>&#45;&gt;</span> bool</code></dt><dd><p>If sequence number is too high, then we need to transfer into Recovery Mode and request the missing sequence to be retransmitted.</p></dd></dl><dl><dt class="spec value" id="val-get_historic_msg"><a href="#val-get_historic_msg" class="anchor"></a><code><span class="keyword">val </span>get_historic_msg : <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a> <span>&#45;&gt;</span> <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></dt><dd><p>get_gap_fill_msg -&gt; out of all of the administrative messages, only the 'Reject' can be retransmitted. All application-level messages may be retransmitted - we should, in the future add logic to not retransmit stale orders, etc.</p></dd></dl><dl><dt class="spec value" id="val-get_critical_reset_seq_num"><a href="#val-get_critical_reset_seq_num" class="anchor"></a><code><span class="keyword">val </span>get_critical_reset_seq_num : <a href="../Full_messages/index.html#type-full_msg_data">Full_messages.full_msg_data</a> <span>&#45;&gt;</span> Imandra_prelude.int option</code></dt><dd><p>This function returns a new sequence number if we got a SequenceReset without GapFill flag. Returns None in all other cases.</p></dd></dl><dl><dt class="spec value" id="val-combine_gapfill_msgs"><a href="#val-combine_gapfill_msgs" class="anchor"></a><code><span class="keyword">val </span>combine_gapfill_msgs : (<a href="../Full_admin_messages/index.html#type-full_msg_sequence_reset_data">Full_admin_messages.full_msg_sequence_reset_data</a><span class="keyword"> * </span><a href="../Full_admin_messages/index.html#type-full_msg_sequence_reset_data">Full_admin_messages.full_msg_sequence_reset_data</a>) <span>&#45;&gt;</span> <a href="../Full_admin_messages/index.html#type-full_msg_sequence_reset_data">Full_admin_messages.full_msg_sequence_reset_data</a></code></dt><dd><p>Give us a single GapFill message with the correct NextSequenceNumber.</p><p>From the specification: &quot;If there are consecutive administrative messages to be resent, it is suggested that only one SeqReset-GapFill message be sent in their place. The sequence number of the SeqReset-GapFill message is the next expected outbound sequence number. The NewSeqNo field of the GapFill message contains the sequence number of the highest administrative message in this group plus 1. For example, during a Resend operation there are 7 sequential administrative messages waiting to be resent. They start with sequence number 9 and end with sequence number 15. Instead of transmitting 7 Gap Fill messages (which is perfectly legal, but not network friendly), a SeqReset-GapFill message may be sent. The sequence number of the Gap Fill message is set to 9 because the remote side is expecting that as the next sequence number. The NewSeqNo field of the GapFill message contains the number 16, because that will be the sequence number of the next message to be transmitted.&quot;</p></dd></dl><dl><dt class="spec value" id="val-add_msg_to_history"><a href="#val-add_msg_to_history" class="anchor"></a><code><span class="keyword">val </span>add_msg_to_history : (<a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a> list<span class="keyword"> * </span><a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a>) <span>&#45;&gt;</span> <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a> list</code></dt><dd><p>Adding a valid message to the list, while</p><ul><li>converting any message that needs to be converted into a SequenceRest-GapFill</li><li>ensuring that any two sequential SequenceReset-GapFill messages are combined into one with an updated expected NextSeqNum parameter</li></ul></dd></dl><dl><dt class="spec value" id="val-create_outbound_fix_msg"><a href="#val-create_outbound_fix_msg" class="anchor"></a><code><span class="keyword">val </span>create_outbound_fix_msg : (Z.t<span class="keyword"> * </span>Imandra_prelude.string<span class="keyword"> * </span>Imandra_prelude.string<span class="keyword"> * </span><a href="../TimeDefaults/index.html#type-fix_utctimestamp">TimeDefaults.fix_utctimestamp</a><span class="keyword"> * </span><a href="../Full_messages/index.html#type-full_msg_data">Full_messages.full_msg_data</a><span class="keyword"> * </span>bool) <span>&#45;&gt;</span> <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></dt><dd><p>Create outbound FIX message with the appropriate header and trailer.</p></dd></dl><dl><dt class="spec value" id="val-create_logon_msg"><a href="#val-create_logon_msg" class="anchor"></a><code><span class="keyword">val </span>create_logon_msg : (<a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a><span class="keyword"> * </span>bool) <span>&#45;&gt;</span> <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></dt><dd><p>Create a logon message we would send out to initiate a connection with another FIX engine.</p></dd></dl><dl><dt class="spec value" id="val-create_logoff_msg"><a href="#val-create_logoff_msg" class="anchor"></a><code><span class="keyword">val </span>create_logoff_msg : <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a> <span>&#45;&gt;</span> <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></dt><dd><p>Create a Logoff message.</p></dd></dl><dl><dt class="spec value" id="val-create_heartbeat_msg"><a href="#val-create_heartbeat_msg" class="anchor"></a><code><span class="keyword">val </span>create_heartbeat_msg : (<a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a><span class="keyword"> * </span>Imandra_prelude.string option) <span>&#45;&gt;</span> <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></dt><dd><p>Create a heartbeat message</p></dd></dl><dl><dt class="spec value" id="val-create_test_request_msg"><a href="#val-create_test_request_msg" class="anchor"></a><code><span class="keyword">val </span>create_test_request_msg : <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a> <span>&#45;&gt;</span> <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></dt><dd><p>Create Test Request message.</p></dd></dl><dl><dt class="spec value" id="val-create_resend_request_msg"><a href="#val-create_resend_request_msg" class="anchor"></a><code><span class="keyword">val </span>create_resend_request_msg : <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a> <span>&#45;&gt;</span> <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></dt><dd><p>Create Resend Request message.</p></dd></dl><dl><dt class="spec value" id="val-create_session_reject_msg"><a href="#val-create_session_reject_msg" class="anchor"></a><code><span class="keyword">val </span>create_session_reject_msg : (Imandra_prelude.int<span class="keyword"> * </span>Imandra_prelude.string<span class="keyword"> * </span>Imandra_prelude.string<span class="keyword"> * </span><a href="../TimeDefaults/index.html#type-fix_utctimestamp">TimeDefaults.fix_utctimestamp</a><span class="keyword"> * </span><a href="../Full_messages/index.html#type-session_rejected_msg_data">Full_messages.session_rejected_msg_data</a>) <span>&#45;&gt;</span> <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></dt><dd><p>Create session-rejection message.</p></dd></dl><dl><dt class="spec value" id="val-create_business_reject_msg"><a href="#val-create_business_reject_msg" class="anchor"></a><code><span class="keyword">val </span>create_business_reject_msg : (Imandra_prelude.int<span class="keyword"> * </span>Imandra_prelude.string<span class="keyword"> * </span>Imandra_prelude.string<span class="keyword"> * </span><a href="../TimeDefaults/index.html#type-fix_utctimestamp">TimeDefaults.fix_utctimestamp</a><span class="keyword"> * </span><a href="../Full_messages/index.html#type-biz_rejected_msg_data">Full_messages.biz_rejected_msg_data</a>) <span>&#45;&gt;</span> <a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></dt><dd><p>Create business reject message. Note: the reason we're separating the ApplicationDown reason is that the parser would not have access to this information.</p></dd></dl><dl><dt class="spec value" id="val-noop"><a href="#val-noop" class="anchor"></a><code><span class="keyword">val </span>noop : (<a href="../Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a><span class="keyword"> * </span><a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a>) <span>&#45;&gt;</span> <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a></code></dt><dd><p>A NO-OPeration</p></dd></dl><dl><dt class="spec value" id="val-business_reject"><a href="#val-business_reject" class="anchor"></a><code><span class="keyword">val </span>business_reject : (<a href="../Full_messages/index.html#type-biz_rejected_msg_data">Full_messages.biz_rejected_msg_data</a><span class="keyword"> * </span><a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a>) <span>&#45;&gt;</span> <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a></code></dt><dd><p>Convert the rejection information into an outbound BusinessReject message.</p></dd></dl><dl><dt class="spec value" id="val-session_reject"><a href="#val-session_reject" class="anchor"></a><code><span class="keyword">val </span>session_reject : (<a href="../Full_messages/index.html#type-session_rejected_msg_data">Full_messages.session_rejected_msg_data</a><span class="keyword"> * </span><a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a>) <span>&#45;&gt;</span> <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a></code></dt><dd><p>Convert the rejection information into an outbound Reject message.</p></dd></dl><dl><dt class="spec value" id="val-field_null"><a href="#val-field_null" class="anchor"></a><code><span class="keyword">val </span>field_null : Imandra_prelude.int option <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-hbeat_interval_null"><a href="#val-hbeat_interval_null" class="anchor"></a><code><span class="keyword">val </span>hbeat_interval_null : <a href="../Datetime/index.html#type-fix_duration">Datetime.fix_duration</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-validate_message_header"><a href="#val-validate_message_header" class="anchor"></a><code><span class="keyword">val </span>validate_message_header : (<a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a><span class="keyword"> * </span><a href="../Full_messages/index.html#type-fix_header">Full_messages.fix_header</a><span class="keyword"> * </span><a href="../Full_message_tags/index.html#type-full_msg_tag">Full_message_tags.full_msg_tag</a>) <span>&#45;&gt;</span> <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a> option</code></dt><dd><p>Check the message header ( presence and value of the OrigSendingTime ) returns None if no problems are found.</p></dd></dl></div></body></html>